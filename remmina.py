from openpyxl import load_workbook
loc = ("remmina.xlsx")

wb = load_workbook(loc)
sheet = wb['Remmina']  # Sheet Name

for row in sheet.iter_rows(min_row=1):
    ip = row[0].value
    hostname = row[1].value
    group = row[2].value
    username = row[3].value
    passhash = row[4].value
    # print(ip, hostname, group)
    filename = "windows_rdp_" + ip + ".remmina"
    f= open (filename, "w+")
    f.write(f"[remmina]\n"
            f"password={passhash}\n"
            f"gateway_username=\n"
            f"notes_text=\n"
            f"vc=\n"
            f"window_height=480\n"
            f"preferipv6=0\n"
            f"ssh_tunnel_loopback=0\n"
            f"serialname=\n"
            f"tls-seclevel=\n"
            f"freerdp_log_level=INFO\n"
            f"printer_overrides=\n"
            f"name= {hostname}\n"
            f"console=0\n"
            f"colordepth=99\n"
            f"security=\n"
            f"precommand=\n"
            f"disable_fastpath=0\n"
            f"postcommand=\n"
            f"left-handed=0\n"
            f"multitransport=0\n"
            f"group= {group}\n"
            f"server= {ip}\n"
            f"ssh_tunnel_certfile=\n"
            f"glyph-cache=0\n"
            f"ssh_tunnel_enabled=0\n"
            f"disableclipboard=0\n"
            f"labels=\n"
            f"audio-output=\n"
            f"parallelpath=\n"
            f"monitorids=\n"
            f"cert_ignore=0\n"
            f"gateway_server=\n"
            f"serialpermissive=0\n"
            f"protocol=RDP\n"
            f"old-license=0\n"
            f"ssh_tunnel_password=\n"
            f"resolution_mode=2\n"
            f"pth=\n"
            f"loadbalanceinfo=\n"
            f"disableautoreconnect=0\n"
            f"clientbuild=\n"
            f"clientname=\n"
            f"resolution_width=0\n"
            f"drive=\n"
            f"relax-order-checks=0\n"
            f"base-cred-for-gw=0\n"
            f"gateway_domain=\n"
            f"profile-lock=0\n"
            f"rdp2tcp=\n"
            f"gateway_password=\n"
            f"serialdriver=\n"
            f"rdp_reconnect_attempts=\n"
            f"domain=\n"
            f"smartcardname=\n"
            f"serialpath=\n"
            f"restricted-admin=0\n"
            f"multimon=0\n"
            f"exec=\n"
            f"enable-autostart=0\n"
            f"usb=\n"
            f"shareprinter=0\n"
            f"network=none\n"
            f"ssh_tunnel_passphrase=\n"
            f"username={username}\n"
            f"disablepasswordstoring=0\n"
            f"quality=0\n"
            f"span=0\n"
            f"shareparallel=0\n"
            f"parallelname=\n"
            f"viewmode=1\n"
            f"ssh_tunnel_auth=0\n"
            f"keymap=\n"
            f"ssh_tunnel_username=\n"
            f"execpath=\n"
            f"shareserial=0\n"
            f"resolution_height=0\n"
            f"timeout=\n"
            f"useproxyenv=0\n"
            f"sharesmartcard=0\n"
            f"freerdp_log_filters=\n"
            f"microphone=\n"
            f"dvc=\n"
            f"ssh_tunnel_privatekey=\n"
            f"gwtransp=http\n"
            f"ssh_tunnel_server=\n"
            f"ignore-tls-errors=1\n"
            f"window_maximize=1\n"
            f"disable-smooth-scrolling=0\n"
            f"gateway_usage=0\n"
            f"window_width=640\n"
            f"no-suppress=0\n"
            f"sound=off\n"
            f"websockets=0")
    f.close()
